<?xml version="1.0" encoding="UTF-8"?>
<metamorph xmlns="http://www.culturegraph.org/metamorph"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://www.culturegraph.org/metamorph metamorph.xsd"
           version="1">

    <meta> <!-- Metadata -->
        <name>MARC-XML to MARC-XML</name>
    </meta>

    <macros> <!-- Macro definitions --> </macros>

    <rules> <!-- Transformation rules-->

        <entity name="leader">
            <data source="leader"/>
        </entity>

        <data name="001" source="001"/>

        <entity name="035  " flushWith="record">
			<concat name="a" delimiter="">
				<data source="001">
					<whitelist map="nzexclude_ids"/>
					<lookup in="nzexclude_ids" default="" />
					<compose prefix="(" postfix=")"/>
				</data>
                <data source="001">
					<whitelist map="nzexclude_ids"/>
                </data>
			</concat>
		</entity>

        <entity name="035  " flushWith="record">
			<concat name="a" delimiter="">
				<data source="001">
					<whitelist map="izexclude_ids"/>
					<lookup in="izexclude_ids" default="" />
					<compose prefix="(" postfix=")"/>
				</data>
                <data source="001">
					<whitelist map="izexclude_ids"/>
                </data>
			</concat>
		</entity>

        <entity name="035  " flushWith="record">
			<concat name="a" delimiter="">
				<data source="020??.a">
					<whitelist map="izexclude_ids"/>
					<lookup in="izexclude_ids" default="" />
					<compose prefix="(" postfix=")"/>
				</data>
                <data source="020??.a">
					<whitelist map="izexclude_ids"/>
                </data>
			</concat>
		</entity>

    </rules>

    <maps>
        <filemap name="nzexclude_ids" files="$[nzexclude_ids]"/>
        <filemap name="izexclude_ids" files="$[izexclude_ids]"/>
    </maps>

</metamorph>
